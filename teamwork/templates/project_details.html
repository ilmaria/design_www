{% extends "base.html" %}
{% load static %}

{% block content %}

<div class="container">
  <!-- Project details -->
  <h1>{{ project.name }}</h1>
  <p>{{ project.description }}</p>

  <!-- Group members -->
  <p><i class="glyphicon glyphicon-user"></i>
    Group member: 
    {% for member in project.members.all %}
      {{ member.user.username }}, 
    {% endfor %}
  </p>
  <button type="button" class="btn btn-default" onclick="openEventCreator()">Add member</button>

  <!-- Task list -->
  <h3>Tasks List</h3>
  <ul class="list-group">
    {% for task in project.task_set.all %}
    <li class="list-group-item">
      <input type="checkbox" 
      {% if task.done %}
      checked 
      {% endif %}> {{ task.name }}</input>
    </li>
    {% endfor %}
  </ul>
  <button type="button" class="btn btn-default" onclick="openEventCreator()">Add task</button>

  <!-- Time Spent -->
  <h3>Time Spent</h3>
  <div class="row">
    <!--  Time spent by each project's members -->
    <div class="col-md-6">
      {% for username, total_time in total_times_per_user %}
      <p>{{ username }} logged {{ total_time }}</p>
      {% endfor %}
      <button type="button" class="btn btn-primary" onclick="openEventCreator()">Log time</button>
    </div>
    <!-- Logged time history from all the project memebers -->
    <div class="col-md-6">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">
            <i class="glyphicon glyphicon-time"></i>
            Log history
          </h3>
        </div>
        <div class="panel-body">
          <ul class="list-group">
            {% for loggedtime in project.loggedtime_set.all|dictsortreversed:'date' %}
            <li class="list-group-item">{{ loggedtime.date }} - {{ loggedtime.student.user.username }} logged {{ loggedtime.hours }}</li>
              {% endfor %}
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- events -->
  <h3>Next Event</h3>
  <ul class="list-group">
    {% for event in project.event_set.all|dictsort:'date' %}
    <li class="list-group-item">
      <p>{{ event.name }}</p>
      <p>{{ event.date }}</p>
      <p><i class="glyphicon glyphicon-map-marker"></i> {{ event.location }}</p>
    </li>
    {% endfor %}
  </ul>
  <button type="button" class="btn btn-default" onclick="openEventCreator()">Add event</button>
</div>

{% endblock %}
