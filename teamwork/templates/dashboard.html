{% extends "base.html" %}
{% load extra_tags %}
{% load next_event %}

{% block content %}
<!-- Next Event from all project -->
<div class="container">
  <h6>Next Event</h6>
  <div class="row">
    <div class="col-xs-2 hidden-xs">
      <img class="img-responsive" src="/static/img/calendar.png" width="80px" alt="cal-icon">
    </div>
    <div class="col-xs-10">
      {% for event in next_event %}
      <strong style="font-size:21px">{{ event.name }}</strong>
      <p style="font-size:21px;">{{ event.date|date:"D, d M Y" }}, {{ event.date|time:"H:i" }}
      {% if event.location != "" %}
      <br />
      <i class="fui-location"></i> {{ event.location }}</p>
      {% endif %}
      {% endfor %}
    </div>
  </div>
</div>

<!-- List of ongoing pojects -->
<div class="container">
  <h6>Ongoing Projects</h6>
  {% for project in projects %}
  <div class="jumbotron">
    <h5>
      <a href="{% url 'project_details' project.name|urlencode_plus %}">
        {{ project.name }}</a>
      </h5>
      {% with next_event=project.event_set.all|dictsort:'date'|next_event %}
      <p><i class="fui-calendar"></i> Next event:
        <strong>{{ next_event.name }}</strong> - {{ next_event.date|date:"D, d M Y" }}, {{ next_event.date|time:"H:i" }}
        <br /><i class="fui-time"></i> Total spent hours:
      </p>
      {% endwith %}
      <div class="form-group">
        <form action="log_time" method="post" id="log-time-form"
        class="form-inline" onsubmit="return validateNewTimelog()">
        {% csrf_token %}
        <div class="from-group">
          <strong>Today time spent:</strong>
        </div>
        <div class="form-group">
          <input id="logHours" type="number" class="form-control bfh-number"
          name="hours" placeholder="Hours">
        </div>
        <div class="form-group">
          <input id="logMinutes" type="number" class="form-control bfh-number"
          name="minutes" placeholder="Minutes">
        </div>
        <div class="form-group">
          <button type="submit" class="btn btn-primary" onclick="validateLogTime(event)">Log time</button>
        </div>
      </form>
    </div>
  </div>
  {% endfor %}

</div>

{% endblock %}
